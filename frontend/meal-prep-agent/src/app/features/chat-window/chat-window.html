<div class="chat-container">
  <h2 class="text-2xl font-bold mb-4">Chat</h2>

  <div class="messages-container">
    @for (message of messages; track $index) {
      <div [class]="message.isUser ? 'chat-bubble user-bubble' : 'chat-bubble ai-bubble'">
        <p class="whitespace-pre-wrap">{{ message.text }}</p>
      </div>
    }

    @if (isLoading && aiResponse) {
      <div class="chat-bubble ai-bubble">
        <p class="whitespace-pre-wrap">{{ aiResponse }}</p>
      </div>
    }

    @if (isLoading && !aiResponse) {
      <div class="chat-bubble ai-bubble">
        <p-skeleton height="45px" class="mb-2">Test</p-skeleton>
        <p class="text-sm text-gray-500 italic mt-2">{{ loadingMessages[loadingMessageIndex] }}</p>
      </div>
    }
  </div>

  <div class="input-container">
    <input
      type="text"
      pInputText
      placeholder="Type a message..."
      class="flex-1"
      [(ngModel)]="currentMessage"
      (keyup.enter)="handleSendMessage()"
      [disabled]="isLoading"
    />
    <p-button
      label="Send"
      (click)="handleSendMessage()"
      [disabled]="isLoading || !currentMessage.trim()"
    />
  </div>
</div>
